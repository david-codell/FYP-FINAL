<!DOCTYPE html>
<html style="font-size: 16px;" lang="en">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8">
  <meta name="keywords"
    content="Sign up and get fresh loot for popular games plus more, Our Story, Innovation in the gameindustry, Sign up and get fresh loot for popular games plus more, Game Gadgets, Download games and play free games every month.">
  <meta name="description" content="">
  <title>adminViewVenue</title>
  <link rel="stylesheet" href="nicepage.css" media="screen">
  <link rel="stylesheet" href="adminViewVenue.css" media="screen">
  <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
  <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
  <meta name="generator" content="Nicepage 5.20.7, nicepage.com">
  <link id="u-theme-google-font" rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">




  <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "",
		"logo": "images/logo-svg.svg"
}</script>
  <meta name="theme-color" content="#478ac9">
  <meta property="og:title" content="adminViewVenue">
  <meta property="og:type" content="website">
  <meta data-intl-tel-input-cdn-path="intlTelInput/">
</head>

<body data-path-to-root="./" data-include-products="false" class="u-body u-xl-mode" data-lang="en">
  <header class="u-clearfix u-header u-header" id="sec-f0f4">
    <div class="u-clearfix u-sheet u-sheet-1">
      <a href="https://nicepage.com" class="u-image u-logo u-image-1" data-image-width="150" data-image-height="150">
        <img src="images/logo-svg.svg" class="u-logo-image u-logo-image-1">
      </a>
      <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
        <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
          <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
            href="#">
            <svg class="u-svg-link" viewBox="0 0 24 24">
              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use>
            </svg>
            <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px"
              xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg">
              <g>
                <rect y="1" width="16" height="2"></rect>
                <rect y="7" width="16" height="2"></rect>
                <rect y="13" width="16" height="2"></rect>
              </g>
            </svg>
          </a>
        </div>
        <div class="u-custom-menu u-nav-container">
          <ul class="u-nav u-unstyled u-nav-1">
            <li class="u-nav-item"><a
                class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                href="adminDashboard.html" style="padding: 10px 20px;">Home</a>
            </li>
            <li class="u-nav-item"><a
                class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                href="adminViewAllUsers.html" style="padding: 10px 20px;">Users</a>
                <div class="u-nav-popup">
                  <ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10">
                    <li class="u-nav-item"><a class="u-button-style u-nav-link u-white" href="adminViewSuspendedEventOrganizer.html">Suspended Event Organizers</a>
                    </li>
                    <li class="u-nav-item"><a class="u-button-style u-nav-link u-white"  href="adminViewNewEventOrganizers.html">New Event Orgainzer Sign Ups</a>
                    </li>
                  </ul>
                </div>
            </li>
            
            <li class="u-nav-item"><a
                class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                href="adminViewAllCategory.html" style="padding: 10px 20px;">Category</a>
                <div class="u-nav-popup">
                  <ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10">
                    <li class="u-nav-item"><a class="u-button-style u-nav-link u-white" href="adminCreateCategory.html">Create Category</a>
                    </li>
                  </ul>
                </div>
            </li>
            <li class="u-nav-item"><a
              class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
              href="adminViewAllVenue.html" style="padding: 10px 20px;">Venues</a>
              <div class="u-nav-popup">
                <ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10">
                  <li class="u-nav-item"><a class="u-button-style u-nav-link u-white" href="adminCreateVenue.html">Create Venue</a>
                  </li>
                </ul>
              </div>
          </li>
          <li class="u-nav-item"><a
            class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
            href="https://marcadriel.grafana.net/public-dashboards/6d56b62141fc4cf89831580905b802b4?orgId=1&refresh=5s" style="padding: 10px 20px;" target="_blank">Metrics</a>
        </li>
            

            <li class="u-nav-item"><a
                class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                style="padding: 10px 20px;" href="Login.html">Logout</a>
            </li>
          </ul>
        </div>
        <div class="u-custom-menu u-nav-container-collapse">
          <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
            <div class="u-inner-container-layout u-sidenav-overflow">
              <div class="u-menu-close"></div>
              <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-3">
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="adminDashboard.html">Home</a>
                </li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="adminViewAllUsers.html">Users</a>
                  <div class="u-nav-popup">
                    <ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10">
                      <li class="u-nav-item"><a class="u-button-style u-nav-link" href="adminViewSuspendedEventOrganizers.html">Suspended Event Organizers</a>
                      </li>
                      <li class="u-nav-item"><a class="u-button-style u-nav-link"  href="adminViewNewEventOrganizer.html">New Event Orgainzer Sign Ups</a>
                      </li>
                    </ul>
                  </div>
                </li>
                
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="adminViewAllCategory.html">Category</a>
                  <div class="u-nav-popup">
                    <ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10">
                      <li class="u-nav-item"><a class="u-button-style u-nav-link" href="adminCreateCategory.html">Create Category</a>
                      </li>
                     
                    </ul>
                  </div>
                </li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="adminViewAllVenue.html">Venues</a>
                  <div class="u-nav-popup">
                    <ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10">
                      <li class="u-nav-item"><a class="u-button-style u-nav-link" href="adminCreateVenue.html">Create Venue</a>
                      </li>
                      
                    </ul>
                  </div>

                </li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="https://marcadriel.grafana.net/public-dashboards/6d56b62141fc4cf89831580905b802b4?orgId=1&refresh=5s" target="_blank">Metrics</a>
                </li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="Login.html ">Logout</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
        </div>
      </nav>
    </div>
  </header>
  <section style="background-color:#040e2d ;" class="u-clearfix u-custom-color-1 u-section-1" id="carousel_9569">
    <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
      <div class="data-layout-selected u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
        <div class="u-layout">
          <div class="u-layout-col">
            <div class="u-size-60">
              <div class="u-layout-col">
                <div class="u-align-center u-container-style u-layout-cell u-size-60 u-layout-cell-1">
                  <div class="u-container-layout u-container-layout-1">
                    <h2 style="color:white;" class="u-align-left u-text u-text-1">View/Update Venue Details</h2>
                    <div class="u-clearfix u-custom-html u-custom-html-1">
                      <style></style>
                      <form style="text-align:left;" id="createVenueForm" enctype="multipart/form-data">
                        <label style="color:white;" for="venueName">Venue Name:</label>
                        <input type="text" id="venueName" name="venueName" required="">
                        <br>
                        <br>
                        <label style="color:white;" for="capacity">Capacity:</label>
                        <input type="text" id="capacity" name="capacity" required="">
                        <br>
                        <br>
                        <label style="color:white;" for="postalcode">Postal Code:</label>
                        <input type="text" id="postalcode" name="postalcode" required="">
                        <br>
                        <br>
                        <label style="color:white;" for="address1">Address1:</label>
                        <input type="text" id="address1" name="address1" required="">
                        <br>
                        <br>
                        <label style="color:white;" for="address2">Address2:</label>
                        <input type="text" id="address2" name="address2" required="">
                        <br>
                        <br>
                        <label style="color:white;" for="img">Upload Image</label>
                        <input type="file" id="img" name="img" accept="image/*">
                        <br>
                        <br>
                        <img id="currentImg" src="" alt="Current Venue Image"
                          style="max-width: 400px; max-height: 400px;">
                        <img id="newImgPreview" src="" alt="New Image Preview"
                          style="max-width: 400px; max-height: 400px;"><br><br>
                          <input type="text" id="venueId" name="venueId" hidden>
                        <button class="u-btn u-button-style u-btn-1" id="update">Update</button>
                        
                        
                      </form>
                      <button class="u-btn u-button-style u-btn-1" id="delete">Suspend</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>




  <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-209f">
    <div class="u-clearfix u-sheet u-sheet-1">
      <p class="u-small-text u-text u-text-variant u-text-1">Sample text. Click to select the Text Element.</p>
    </div>
  </footer>
  <section class="u-backlink u-clearfix u-grey-80">
    <a class="u-link" href="https://nicepage.com/templates" target="_blank">
      <span>Templates</span>
    </a>
    <p class="u-text">
      <span>created with</span>
    </p>
    <a class="u-link" href="" target="_blank">
      <span>Offline Website Builder</span>
    </a>.
  </section>

</body>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $("#homepage").on("click", function () {
    window.location.href = "adminViewAllVenue.html";
  });

  $(document).ready(function () {
    // Fetch venue data and populate the form

    const queryParams = new URLSearchParams(window.location.search);
    const venueidfromURL = queryParams.get("venueId");
    console.log(venueidfromURL);

    var currentImgFileName;

    // Add a change event listener to the file input
    $("#img").on("change", function () {
      var file = this.files[0];
      if (file) {
        console.log("New image selected:", file);
        var reader = new FileReader();

        reader.onload = function (e) {
          // Update the src attribute of the preview image with the new image data
          $("#newImgPreview").attr("src", e.target.result);
        };

        reader.readAsDataURL(file);
      } else {
        // Clear the preview image if no file is selected
        $("#newImgPreview").attr("src", "");
      }
    });





    var urllink = "https://lit-fjord-36112-28d351dbba2f.herokuapp.com/getVenueById?venueId=" + venueidfromURL;
    $.ajax({
      type: "GET",
      url: urllink,
      dataType: "json",
      success: function (response) {
        if (response.code === 200) {
          var venue = response.data[0]; // Assuming there is only one venue in the response

          // Populate the form fields with venue data
          $("#venueId").val(venue.venueId);
          $("#venueName").val(venue.venueName);
          $("#capacity").val(venue.capacity);
          $("#postalcode").val(venue.postalcode);
          $("#address1").val(venue.address1);
          $("#address2").val(venue.address2);


          var currentImgFileName = venue.img;
          const imageUrl = "https://firebasestorage.googleapis.com/v0/b/fyp2023-s3-03.appspot.com/o/venue%2F" + currentImgFileName + "?alt=media";
          $("#currentImg").attr("src", imageUrl);
          console.log("currentImg:", imageUrl);


        } else {
          // Handle error or empty response
          console.error("Failed to fetch venue data.", response.message);
        }
      },
      error: function (xhr, status, error) {
        console.error("Error fetching venue data:", error);
      }

    })




    

  });
  $("#delete").on("click", function () {
    const queryParams = new URLSearchParams(window.location.search);
    const venueidfromURL = queryParams.get("venueId");
      if (confirm("Are you sure you want to delete this venue?")) {
        $.ajax({
          type: "DELETE",
          url: "https://lit-fjord-36112-28d351dbba2f.herokuapp.com/deleteVenueById?venueId=" + venueidfromURL, // Send venueId as a query parameter
          dataType: "json",
          success: function (response) {
            if (response.code === 200) {
              // Handle success - for example, redirect to a different page or show a success message
              alert("Venue deleted successfully!");
              window.location.href = "adminViewAllVenue.html";

            } else {
              // Handle other status codes or errors
              alert("Failed to delete venue. " + response.message);
            }
          },
          error: function (error) {
            // Handle Ajax error
            alert("An error occurred while making the request: " + error.statusText);
          }
        });
      }
    });
  $("#createVenueForm").on("submit", async function (e) {
    e.preventDefault();
    console.log("Update button clicked");
    var updatedVenueId = $("#venueId").val();
    var updatedVenueName = $("#venueName").val();
    var updatedCapacity = $("#capacity").val();
    var updatedPostalcode = $("#postalcode").val();
    var updatedAddress1 = $("#address1").val();
    var updatedAddress2 = $("#address2").val();
    var updatedImg = $("#img")[0].files[0];



    console.log("Venue ID:", updatedVenueId);
    console.log("Venue Name:", updatedVenueName);
    console.log("Capacity:", updatedCapacity);
    console.log("Postal Code:", updatedPostalcode);
    console.log("Address1:", updatedAddress1);
    console.log("Address2:", updatedAddress2);
    console.log("Updated Image:", updatedImg);
    
    var formData = new FormData();
    formData.append("venueId", updatedVenueId);
    formData.append("venueName", updatedVenueName);
    formData.append("capacity", updatedCapacity);
    formData.append("postalcode", updatedPostalcode);
    formData.append("address1", updatedAddress1);
    formData.append("address2", updatedAddress2);
    formData.append("img", updatedImg);

    console.log("Form data:", formData);
    try {
      const response = await $.ajax({
        type: "POST",
        url: "https://lit-fjord-36112-28d351dbba2f.herokuapp.com/updateVenueById",
        data: formData,
        contentType: false,
        processData: false
      });
      if (response) {
        // Handle success response
        console.log(response);
        alert("Venue updated successfully!");
        window.location.href = "adminViewAllVenue.html"
      }
    } catch (error) {
      // Handle error response
      console.error(error);
    }
    /*$.ajax({
      type: "POST",
      url: 'https://lit-fjord-36112-28d351dbba2f.herokuapp.com/updateVenueById',
      data: formData,
      processData: false,
      contentType: false,
      success: function (response) {
        console.log(response.code);
        if (response.code === 200) {
          $("#message").text("Venue data updated successfully!");
          window.location.replace("adminViewAllVenue.html");

          // Optionally, you can show an alert after the page change if needed
          alert("Venue updated successfully!");
        } else {
          $("#message").text("Failed to update venue data.");
        }
      },


    });*/
  });
</script>

</html>